# movie-paletter
Generates color palettes for each frame of a movie. Also allows you to search for a frame in which a chosen color is a dominant color.

*<sup>The current version works but is not very user friendly. The next update will provide a more intuitive interface.</sup>*

![demo](https://github.com/DeeFrancois/movie-paletter/blob/master/ReadmeImages/demo.gif)

<sup><sup> Movie: The Secret Life of Walter Mitty</sup></sup>

<sup> Requires [awthemes 10.4.0](https://sourceforge.net/projects/tcl-awthemes/), download and place into the same folder </sup>

## Motivation
I wanted to make one of those movie collage posts on Twitter and thought it would be cool if I had a program that made it easy for me to keep to a certain color scheme

## How it works
- Open Movie File (only .mp4 works so far)
- Move bottom left slider to change the seek speed and click the Start button
- Choose your desired color and the seeking will automatically pause when it finds a match
- Click the bottom left picture to save the frame

#### Sliders
- Slider #1 (Top Left): Seek Bar
- Slider #2 (Bottom Left): Set Seek Speed
- Slider #3 (Top Right): Difference factor between colors when generating palette (Higher = More distinct colors in final palette)
- Side #4 (Bottom Right): Difference threshold for determining a color match (Lower = Closer Match)

## Other features
- Click on the current palette to fill the top bar with its RGB values
- You can drag on the seek bar to get palettes while paused
- Click the image of your chosen color to see how different it is from each color in the current palette 

# A peek into the process
Originally, the palette was generated by using an algorithm that went through each pixel and returned a list of RGB values sorted by frequency.
This was a problem because it would often result in one color drowning out the rest. Here's an example:

Let's say we have this frame:

![frame](https://github.com/DeeFrancois/movie-paletter/blob/master/ReadmeImages/example_frame.png)

Looking at this frame, the ideal color palette should consist of:
- That gray/beige color in the background
- The color of Walter's shirt
- The color of Cheryl's shirt
- The dark shadows
- The color of the guy's shirt to the right of Cheryl
- and maybe the red from the woman to the left of Walter

But with the original algorithm we get:

![frame](https://github.com/DeeFrancois/movie-paletter/blob/master/ReadmeImages/example_before.png)

Because there are so many dark pixels, it drowns out the colors that stand out to us.
I fixed this by coalescing all the darkest RGB values into one color on the palette. So now we have this:

![frame](https://github.com/DeeFrancois/movie-paletter/blob/master/ReadmeImages/example_muddy.png)

This is still not what we want. We have essentially the same issue as before, except this time we can't just map every non-dark color to one color.
The solution here is to incorporate a "Difference Factor" into the algorithm which will allow us to check if a color is actually distinct before adding it to the final palette.

<sup>The Difference Factor is calculated using the equation described [here](https://en.wikipedia.org/wiki/Color_difference)</sup>

And now for the result..

![frame](https://github.com/DeeFrancois/movie-paletter/blob/master/ReadmeImages/example_frame.png)
![frame](https://github.com/DeeFrancois/movie-paletter/blob/master/ReadmeImages/example_after.png)

With a Difference Factor threshold of 30 (which seems to be the sweet spot so far) as chosen by Slider #3, we end up getting all the colors we were looking for except the red. 
The red doesn't show up because it's obscured by too many dark pixels. It stands out because it is a bright color, not because it is a common color. Accounting for brightness/vividness vs frequency is something I can implement in the future, but for now I think this works well. 


